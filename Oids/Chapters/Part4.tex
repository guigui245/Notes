% !TeX root = ../main.tex
% 
\lhead{\emph{Lecture 4}}
\section{Lecture 4: Differential Operators} % (fold)
\label{sec:lecture_4}
% 
\subsection{Derivations} % (fold)
\label{sub:derivations}
Let $A$ be a associative commutative unital $\mathbb{C}$-algebra, a vector space over $\mathbb{C}$ such that for any pair $a,b \in A$, the product $ab \in A$ is bilinear and associative. 
\definition{
    A \textbf{derivation} $\partial \in \mathrm{Der}_\mathbb{C}(A)$ is a $\mathbb{C}$-linear map $\partial : A \rightarrow A$ such that the Leibniz identity is satisfied,
    \begin{equation}
        \partial(ab) = \partial (a) b + a \partial(b)
    \end{equation}\label{eq:liebniz}
    for $a,b \in A$.
    Clearly, $\mathrm{Der}_\mathbb{C}(A) \subseteq \mathrm{End}_\mathbb{C}(A)$
}\label{def:derivation}

\definition{
    More generally, if $B$ is a commutative ring, $A$ is a $B$-algebra and $M$ an $A$-bimodule then 
    $\mathrm{Der}_B(A,M) = \{ \partial \in \mathrm{Hom}_B(A,M) \big| \forall a,b \in A, \partial (ab) = a \partial (b) + \partial (a) b \} $.
}\label{def:derivation_over_ring}

\proposition{
    If $\partial \in \mathrm{End}_\mathbb{C}(A)$ is a derivation $\Leftrightarrow$ $\partial(\mathbb{C}) = 0$ and for all $a \in A$, $\partial a -a \partial \in A$.  

    \begin{proof}
        Let $b \in A$, then the Leibniz identity is equivalent to
        \begin{align*}
            \left( \partial a - a \partial\right)(b) &= \partial(ab) - a \partial(b)\\
            &=\partial(a) b.
        \end{align*}
        \begin{itemize}
            \item $\Rightarrow$ Assuming $\partial$ is a derivation, then the argument above shows that $\partial a - a \partial \in A \subseteq \mathrm{End}_\mathbb{C}(A)$, where left multiplication by this operator is the endomorphism map induced. 
            Furthermore, since $\partial$ is $\mathbb{C}$-linear, and considering $\mathbb{C}$ as a $\mathbb{C}$-vector space over itself, the Leibniz identity implies
            \begin{align*}
                \partial (1 z) &= \partial(1) z + 1 \partial(z)\\
                &\Rightarrow \partial(1) = 0.  
            \end{align*}
            Therefore $\partial(\mathbb{C}) = 0$.
            \item $\Leftarrow$ Suppose $a \partial - a \partial = c$ for some $c \in A$ and $\partial(\mathbb{C}) = 0$, then
            \begin{align*}
                (\partial a - a \partial ) (1) &= c(1)\\
                \partial(a) = c
            \end{align*}
            therefore $\partial$ follows Leibniz identity.
        \end{itemize}
    \end{proof}
}\label{prop:leibniz_equiv}
% 
\example{
    On polynomial rings, we have $\mathrm{Der}_\mathbb{C}( \mathbb{C}[x]) = \mathbb{C}(x) \frac{d}{dx}$.
    Clearly, the inclusion $\mathbb{C}[x] \frac{d}{dx} \subseteq \mathrm{Der}_\mathbb{C}(\mathbb{C}[x])$ is trivial by just checking that it satisfies Leibniz identity.
    However, for the reverse inclusion, consider a derivation $\partial \in \mathrm{Der}_\mathbb{C}(\mathbb{C}[x])$, then we claim that a basis is given by
    \begin{equation}
        \partial := \partial(x) \frac{d}{dx}.
    \end{equation}
    Easy to check that acting on the unit $1 \in \mathbb{C}$ and $x$, these definitions agree.
    Therefore, by $\mathbb{C}$-linearity and Leibniz property, they agree on $\mathbb{C}[x]$.

    More generally,
    \begin{equation}
        \mathrm{Der}_\mathbb{C}(\mathbb{C}[x_1, \ldots, c_n]) = \bigoplus_{i=1}^n\mathbb{C}[x_1, \ldots, x_n] \frac{\partial}{\partial x^i}
    \end{equation}
    \example{
        If $A = C^\infty(M)$, the algebra of smooth functions on $M$, then
        \begin{equation}
            \mathrm{Der}_\mathbb{R}(C^\infty(M)) = \mathcal{X}(M)
        \end{equation}
    }\label{ex:vector_field}
}\label{ex:derivation_on_poly_ring}
% subsection derivations (end)
% ---------------------------------------------------------------------------------------------
\subsection{Differential operators} % (fold)
\label{sub:differential_operators}
% 
In this section we define the more general concept of a differential operator, which are \textbf{not} necessarily derivations. There are two different ways to define them.
\definition[First definition]{
    The ring $D(A)$ of $\mathbb{C}$-linear \textbf{differential operators} on $A$ is the subalgebra of $\mathrm{End}_\mathbb{C}(A)$ generated by $A$ and $\mathrm{Der}_\mathbb{C}(A)$.
    Let $\theta \in D(A)$, it has \textit{order} $p$ if it is the sum of products on at most $p$ derivations.\\
    e.g: $\frac{d^2}{dx^2} + 1 = \left(\frac{d}{dx}\right)^2 + 1 $ has order 2.
}\label{def:diff_op_1}

% 
We can generalise this definition a little.
\definition[Second definition]{
    % The differential operators of order at most $p$ can be defined another way. 
    A \textbf{regular} differential operator of order p is an element of
    $D^p(A) = \{ \theta \in \mathrm{End}_\mathbb{C}(A) \; \vert \theta a - a \theta = \theta(a) \in D^{p-1}(A) \quad \forall a \in A \} $, with $D^0(A) = A$.
    The ring of \textbf{regular differential operators} is $D(A) = \bigcup D^p(A)$ and it is easy to see that
    \begin{equation}
        D^p(A)D^r(A) \subseteq D^{p+r}(A).
    \end{equation}
    and $D^{p+1}(A) \supseteq D^p(A)$ so this defines a filtration.
}\label{def:diff_op_2}

We relate the two definitions in the following sense.
Suppose $\theta \in D^1(A)$, then
\begin{equation}
    \theta = (\theta - \theta(1)) + \theta(1)
\end{equation}
implying that $D^1(A) \cong \mathrm{Der}_\mathbb{C}(A) \oplus A$. So we can generate the ring of differential operators on $A$ and clearly $\mathrm{def} 1 \subset \mathrm{def} 2$. 

\theorem[Grothendieck]{
    The two definitions are equivalent if and only if $X = \mathrm{Spec}_A$ is non-singular.
    In this case, the ring of differential has the simple expression
    \begin{equation}
        D(A) = \faktor{T_A(\mathrm{Der}_\mathbb{C}(A))}{\theta \otimes \theta' - \theta' \otimes \theta - [\theta, \theta']}
    \end{equation}
    where $T_A$ is the tensor algebra.
    Recall that the \textit{spectrum} of a ring $\mathrm{Spec}(R)$ is the set of all prime ideals of $R$ with the Zariski topology.
    \citep{Coutinho1995}
}\label{thm:equiv_def}

\example{
    Consider the ring $A = \mathbb{C}[x]$ of rational functions over $\mathbb{C}$, then the algebra of derivations over this ring
    \begin{equation}
        \mathrm{Der}_\mathbb{C}(A) = \mathbb{C}[x] \frac{d}{dx} := W
    \end{equation}
    is called the \textit{Witt} algebra.
    However, the ring $D(A)$ of differential operators on $A$ can also be viewed as the polynomial ring constructed by quotienting the free $\mathbb{C}$-algebra on $x, \partial$ by the ideal
    \begin{equation}
        D(A) = \faktor{\mathbb{C} \langle x, \partial = \frac{d}{dx} \rangle}{x \partial -\partial x - 1}.
    \end{equation}
    This is called a \textit{Weyl} algebra.
}\label{ex:diff_example}

As noted earlier, the second definition is more general. Here is an example where the equality fails.

\example{
    Consider $A = \mathbb{C}[t^2,t^3]$. Then $\mathrm{Spec}(A)$ is the space of proper prime ideals 
    \begin{equation}
        \mathrm{Spec}(A) = \left\{ \langle t^2-a, t^3-b \rangle, (a,b) \in \mathbb{C}^2\right\} 
        \bigcup \left\{ \langle f(t^2,t^3) \rangle, \textrm{f is irreducible} \right\}
        \cup \{\langle 0 \rangle\} 
    \end{equation}
    This space has a singular point and somehow this implies that there exists differential operators at that point that are not generated by sum-products of derivations.
    EXPAND ON THIS
}\label{ex:diff_op_not_equiv}

\lemma{
    Let $\theta \in D^p(A)$ and $\theta' \in D^r(A)$ then
    \begin{equation}
        \left[\theta, \theta'\right] :=\theta \cdot \theta' - \theta' \cdot  \theta \in D^{p+r-1}(A)
    \end{equation}
}\label{lem:commutatot_of_diff_op}
In particular, $D^1(A)$ and $\mathrm{Der}_\mathbb{C}(A)$ are \textit{Lie algebras}. Not true for higher order as it doesn't close. But below we will see a way to make it into a Lie algebra.

\question{
    Given algebras $A,B$ with respective spectrum $X = \mathrm{Spec}(A)$, $Y = \mathrm{Spec}(B)$. If $D(A) \cong D(B)$, does that mean that $X \cong Y$?
    This turns out to be \textbf{false} if the algebraic varieties are allowed to be singular.
}
% subsection differential_operators (end)
\subsection{From differential operators to Poisson algebras} % (fold)
\label{sub:from_differential_operators_to_poisson_algebras}
We have seen in \cref{lem:commutatot_of_diff_op} that $\left[D^p(A), D^r(A)\right]\subseteq D^{p+r-1}(A)$. 
In particular, for Lie subalgebra $\mathrm{Der}_\mathbb{C}(A) \subseteq D(A)$, if $\delta,\delta' \in \mathrm{Der}_\mathbb{C}(A)$ then $\left[\delta,\delta'\right] \in \mathrm{Der}_\mathbb{C}(A)$,
\begin{align*}
    [\delta, \delta'](ab) &= \delta \delta'(ab) - \delta' \delta(ab)\\
    &=\delta (\delta'(a) b + a \delta'(b)) - \delta'( \delta(a)b + a\delta(b))\\
    &= \delta \delta'(a)b + a \delta \delta'(b) - \delta' \delta(a) b - a \delta' \delta(b)\\
    &= [\delta, \delta'](a)b + a [\delta,\delta'](b)
\end{align*}
\definition{
    Given the filtration of regular differential operators $D(A)$ on algebra $A$, we define its grading $\mathrm{gr}\,D(A)$ as 
    \begin{equation}
        \mathrm{gr}\,D(A) = \bigoplus_p \faktor{D^p(A)}{D^{p-1}(A)}
    \end{equation}
}\label{def:grading}

\proposition{
    The grading of differential operators on $A$ is a commutative ring under composition and a Poisson algebra with bracket generated by the commutator $[\cdot,\cdot]$.
}\label{prop:grading_is_poisson}
\begin{proof}
\begin{itemize}
    \item Let $\pi \in D^p(A)$ and $\rho \in D^r(A)$, then $\pi \rho, \rho \pi \in D^{p+r}(A)$ while $[\pi, \rho] \in D^{p+r-1}(A)$.
    So 
    \begin{equation}
        \pi \rho \sim \rho \pi + D^{p+r-1}(A)
    \end{equation}
    but as elements $\mathrm{gr}\,(\pi \rho), \mathrm{gr}\,(\rho \pi) \in \mathrm{gr} \, D(A)$, we have $\mathrm{gr}\,(\pi \rho) = \mathrm{gr}\,(\rho \pi)$
    \item $\left(\mathrm{gr} \, D(A), \{\cdot, \cdot\} \right)$ is a Lie algebra. 
    Taking the bracket on differential operators, we induce the Lie bracket $\{\cdot,\cdot\} : \mathrm{gr}\, D(A) \times \mathrm{gr}\, D(A) \rightarrow \mathrm{gr}\, D(A) $ by 
    \begin{align*}
        \{\mathrm{gr} \,\rho, \mathrm{gr}\, \pi\} &:= \mathrm{gr}\,  [\rho, \pi] \\
        &= [\rho,\pi] + D^{p+r-2}(A)
    \end{align*}
    for $\pi \in D^p(A)$, $\rho \in D^r(A)$. Given that $[\cdot,\cdot]$ is a Lie bracket on $D^1(A)$, we extend it to $\mathrm{gr} \, D(A)$ so that $\{\cdot, \cdot\}$ is a bracket up to an element of the quotient. 
    \item The adjoint action is a derivation. This is shown SOMEDAY.
\end{itemize}

\end{proof}

In fact, if $X = \mathrm{Spec}(A)$ is non-singular,
\begin{align*}
    \mathrm{gr}\, D(A) &= \mathrm{gr}\, \left( \frac{T_A(\mathrm{Der}_\mathbb{C}(A))}{\delta \otimes \delta' - \delta' \otimes \delta - [\delta,\delta']}  \right)\\
    &= \frac{T_A(\mathrm{Der}_\mathbb{C}(A))}{\delta \otimes \delta' - \delta' \otimes \delta}.
\end{align*}
So in this case, $\mathrm{gr}\, D(A) = \mathrm{Sym}_A(\mathrm{Der}_\mathbb{C}(A))$, and since we can identify the derivations with category of vector fields on $X$,
\begin{equation}
    \mathrm{Der}_\mathbb{C}(A) = \mathbb{V}ect(X) = \mathbb{C}[T^*X]
\end{equation}

Possible connection with $L_\infty$-algebras. see \citep{Braun2013}
% subsection from_differential_operators_to_poisson_algebras (end)
\subsection{Weyl algebras} % (fold)
\label{sub:weyl_algebras}
Let $A = \mathbb{C}[x_1, \ldots, x_n]$ then the ring of differential operator on $A$ is constructed akin to \cref{ex:diff_example} as the free algebra in $\{x_i, y_i = - \partial_i\}$ variables
\begin{equation}
    D(A) \cong \frac{\mathbb{C} \langle x_1, \ldots, x_n, y_1, \ldots, y_n\rangle}{[x_i, y_j] = \delta_{ij}, \textrm{ rest commutes}}.
\end{equation}
This is the $n^{th}$ \textbf{Weyl Algebra} $D(A)$ which is a simple ring (i.e: it does not have a proper $2$-sided ideal).
Its grading is the Poisson simple algebra
\begin{equation}
    \mathrm{gr}\, D(A) = \mathbb{C}[x_1,\ldots,x_n,y_1,\ldots,y_n]
\end{equation}
with Poisson brackets
\begin{align}
    \{x_i,y_j\} = \delta_{ij} \qquad \{x_i,x_j\}=0=\{y_i,y_j\}
\end{align}
This is sometimes called \textit{the first example}.

\remark{
    $D(\mathbb{C}[x])$ has no non-trivial finite dimensional modules. This is because, assuming $V$ is a $D(\mathbb{C}[x])$-module of complex dimension d. Then $D(\mathbb{C}[x])$ acts on V as an endomorphism.
    Let $X,Y \in \mathrm{Mat}_{d \times d}(\mathbb{C})$ such that $[X,Y] = \mathbbm{1}_d$, then $\mathrm{tr}([X,Y]) = 0 \neq d$, which is a contradiction.
}\label{rem:fin_dim}

\proposition{
    Let $I$ be a right ideal of $D(A)$. Then $J = \mathrm{gr}\, (I)$ is an ideal of $\mathrm{gr}\, D(A)$ and it is \textbf{involutive/coisotrope} 
    \begin{equation}
        \{J,J\} \subseteq J
    \end{equation}
}\label{prop:weyl_ideals}
\begin{proof}
    Let $\theta, \eta \in I$ then $[\theta, \eta] \in I$ since it is a right ideal.
    Taking the grading, $\mathrm{gr}\, [\theta, \eta] \equiv \{\mathrm{gr}\,\theta, \mathrm{gr}\, \eta\}\subseteq J$
\end{proof}

\theorem[Gabber]{
    If $J = \mathrm{gr}\, (I)$ is coisotrope for some right ideal $I$ of $D(A)$, then the radical $\sqrt{J} := \{ \theta \vert \exists \textrm{ k, s.t } \theta^k \in J\}$ is also coisotrope. 
    % hard to prove
}\label{thm:Gabber}

\corollary[Bernstein's inequality]{
    Using Gabber's theorem and Hilbert Nullstellensatz $\sqrt{J} = I(V(J))$, we see that 
    \begin{equation}
        \mathrm{dim}(V(J) \subseteq \mathbb{C}^{2n}) \geq n
    \end{equation}
}\label{cor:Bernstein}

\example{
    Let $A = \mathbb{C}[x,y]$ with $\{x,y\}=1$. Consider the coisotrope subring $J = \langle x^2, xy, y^2 \rangle$. It has radical $\sqrt{J} = \langle x,y \rangle$, but the radical is \textit{not} coisotrope.
    Therefore $J$ is \textbf{not} the grading of some right ideal of $D(\mathbb{C}[x,y])$.
}

% subsection weyl_algebras (end)
% section lecture_4 (end)